const sinon = require("sinon")
const test = require("cotest")

const injectable = require("./injectable")

test("normal parameters are forwarded to the route", function* (t) {
  const get = sinon.spy()
  const route = injectable({get})
  yield route().get(1, 2)
  t.deepEqual(get.firstCall.args, [1, 2])
  t.end()
})

test("dependencies are forwarded to the route", function* (t) {
  const get = sinon.spy()
  const route = injectable({get})
  yield route(1, 2).get()
  t.deepEqual(get.firstCall.args, [1, 2])
  t.end()
})

test("dependencies are added after normal parameters", function* (t) {
  const get = sinon.spy()
  const route = injectable({get})
  yield route(2).get(1)
  t.deepEqual(get.firstCall.args, [1, 2])
  t.end()
})
